{% extends "theme.html" %}
{% load staticfiles %}

{% block title %}
    View Pending Requests
{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'css/PendingRequests.css' %}"/>
{% endblock %}
{% block jQueryCall %}
{#    <script src="{% static 'js/AdminAccountVerification.js' %}" type="text/javascript"></script>#}
    <script>
    $("#accept_button").on('click', function () {
      var user_id = $(this).val();
      var is_active = 1;
      console.log(user_id);
      $.ajax({
        url: "{% url 'change_accept_status' %}",
        data: {
          'csrfmiddlewaretoken': $('input[name="csrfmiddlewaretoken"]').val(),
          'is_active': is_active,
          'user_id': user_id
        },
        dataType: 'json',
        success: function (data) {
          if (data.success) {
            console.log("ajax call success.");
          }else{
            console.log("ajax call not success.");
          }
        }
      });
    });
    $("#reject_button").on('click', function () {
      var user_id = $(this).val();
      var is_active = 0;
      console.log(user_id);
      $.ajax({
        url: "{% url 'change_accept_status' %}",
        data: {
          'csrfmiddlewaretoken': $('input[name="csrfmiddlewaretoken"]').val(),
          'is_active': is_active,
          'user_id': user_id
        },
        dataType: 'json',
        success: function (data) {
          if (data.success) {
            console.log("ajax call success.");
          }else{
            console.log("ajax call not success.");
          }
        }
      });
    });
    </script>
{% endblock %}

{% block content %}
    <div id="pendingRequestBody" class="col-12 text-center">
        {% if user_type == 'admin' %}
            <h2>Pending Requests</h2>
            <hr>
            <form method="POST" class="form-horizontal">
            {% csrf_token %}
                <table id="request_table" class="mx-auto">
                    {% for employer in employers %}
                        <tr class="my-2">
                            <td class="text-left">{{ employer }}</td>
                            <td>
                                <button id="accept_button" class="btn btn-success" type="button" name="accept" value="{{employer.user_id}}">Accept</button>
                            </td>
                            <td>
                                <button id="reject_button" class="btn btn-danger" type="button" name="reject" value="{{employer.user_id}}">Reject</button>
                            </td>
                        </tr>
                    {% endfor %}
                </table>
            </form>
        {% endif %}
    </div>
{% endblock %}
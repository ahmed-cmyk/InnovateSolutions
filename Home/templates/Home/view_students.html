{% extends 'theme.html' %}
{% load staticfiles %}
{% load crispy_forms_tags %}

{% block title %}
    View Students - Murdoch Dubai Job Portal
{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/View.css' %}"/>
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>
    <script src="{% static 'js/viewStudents.js' %}" type="text/javascript"></script>
{% endblock %}

{% block content %}
    <div id="viewBody">
        <div class="text-center">
            <h2>Browse Students</h2>
            <hr class="horizontal-rule">
        </div>
        {% if user_type != 'student' %}
            <!-- Button trigger modal -->
            <div class="text-center d-block d-sm-none">
                <button type="button" class="btn btn-danger padding" data-toggle="modal" data-target="#filterStudents">
                  Filter Students
                </button>
            </div>
            <!-- Modal -->
            <div class="modal fade" id="filterStudents" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                  <div class="modal-header bg-danger">
                    <h5 class="modal-title" id="exampleModalLongTitle">Filter Students Listing</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                    <form method="POST">
                        <div class="modal-body">{% csrf_token %}
                            <p>{{ form.alumni_status|as_crispy_field }}</p>
                            <p>{{ form.skills|as_crispy_field }}</p>
                            <p>{{ form.min_graduation_date|as_crispy_field }}</p>
                            <p>{{ form.max_graduation_date|as_crispy_field }}</p>
                            <a href='../view_students'>View All Students</a>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <button type="Submit" class="btn btn-primary"><b>Apply Filters</b></button>
                          </div>
                    </form>
                </div>
              </div>
            </div>
        {% endif %}
        <div class="row">
            <div id="filterForm" class="col-md-4 col-sm-4 col-xs-12 d-none d-sm-block">
                <form method="POST">{% csrf_token %}
                    <div id="formHeader" class="text-center">
                        <h5 class="text-white">Filter Students Listings</h5>
                    </div>
                    <div class="form-group">
                        <p>{{ form.alumni_status|as_crispy_field }}</p>
                        <p>{{ form.skills|as_crispy_field }}</p>
                        <p>{{ form.min_graduation_date|as_crispy_field }}</p>
                        <p>{{ form.max_graduation_date|as_crispy_field }}</p>
                        <a href='../view_students'>View All Students</a>
                    </div>
                    <div class="text-center">
                        <button type="button" class="btn btn-secondary">Close</button>
                        <button type="Submit" class="btn btn-primary"><b>Apply Filters</b></button>
                    </div>
                </form>
            </div>
            <div class="col-md-8 col-sm-8 col-xs-12">
                {% if user_type != 'student' %}
                    <div class="float-right">
                        <input type="text" id="myInput" onkeyup="myFunction()" placeholder="Search for Student Names...">
                    </div>
                    <table id="myTable" class="table padding">
                        <thead class="thead-dark">
                        <tr class="text-center">
                            <th>Student Name</th>
                            <th>Email</th>
                            <th>Expected Graduation Date</th>
                        </tr>
                        </thead>
                        <tbody>
                            {% for student in students %}
                                <tr class="text-center">
                                <td>
                                    <a href="{% url 'student_details' student.user_id %}"> {{ student.user.first_name }} {{ student.user.last_name }}</a>
                                </td>
                                <td>{{ student.user }}</td>
                                <td>{{ student.expected_graduation_date }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% endif %}
            </div><!-- End of col -->
        </div><!-- End of row -->
    </div>
{% endblock %}